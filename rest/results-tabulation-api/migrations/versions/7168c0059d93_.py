"""empty message

Revision ID: 7168c0059d93
Revises: a4b00dd4b387
Create Date: 2020-01-16 15:18:30.548465

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql

# revision identifiers, used by Alembic.
revision = '7168c0059d93'
down_revision = 'a4b00dd4b387'
branch_labels = None
depends_on = None


def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.create_table('tallySheetVersionRow',
    sa.Column('tallySheetVersionRowId', sa.Integer(), nullable=False),
    sa.Column('templateRowId', sa.Integer(), nullable=False),
    sa.Column('tallySheetVersionId', sa.Integer(), nullable=False),
    sa.Column('electionId', sa.Integer(), nullable=False),
    sa.Column('areaId', sa.Integer(), nullable=True),
    sa.Column('candidateId', sa.Integer(), nullable=True),
    sa.Column('partyId', sa.Integer(), nullable=True),
    sa.Column('numValue', sa.Integer(), nullable=True),
    sa.Column('strValue', sa.String(length=100), nullable=True),
    sa.ForeignKeyConstraint(['areaId'], ['area.areaId'], ),
    sa.ForeignKeyConstraint(['candidateId'], ['candidate.candidateId'], ),
    sa.ForeignKeyConstraint(['electionId'], ['election.electionId'], ),
    sa.ForeignKeyConstraint(['partyId'], ['party.partyId'], ),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], ),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId')
    )
    op.create_table('tallySheet_tallySheet',
    sa.Column('parentTallySheetId', sa.Integer(), nullable=False),
    sa.Column('childTallySheetId', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['childTallySheetId'], ['tallySheet.tallySheetId'], ),
    sa.ForeignKeyConstraint(['parentTallySheetId'], ['tallySheet.tallySheetId'], ),
    sa.PrimaryKeyConstraint('parentTallySheetId', 'childTallySheetId')
    )
    op.create_table('template',
    sa.Column('templateId', sa.Integer(), nullable=False),
    sa.Column('templateName', sa.String(length=100), nullable=False),
    sa.PrimaryKeyConstraint('templateId')
    )
    op.create_table('templateRow',
    sa.Column('templateRowId', sa.Integer(), nullable=False),
    sa.Column('templateId', sa.Integer(), nullable=True),
    sa.Column('templateRowType', sa.String(length=200), nullable=False),
    sa.Column('hasMany', sa.Boolean(), nullable=False),
    sa.Column('isDerived', sa.Boolean(), nullable=False),
    sa.ForeignKeyConstraint(['templateId'], ['template.templateId'], ),
    sa.PrimaryKeyConstraint('templateRowId')
    )
    op.create_table('templateRowColumn',
    sa.Column('templateRowColumnId', sa.Integer(), nullable=False),
    sa.Column('templateRowId', sa.Integer(), nullable=True),
    sa.Column('templateRowColumnName', sa.String(length=200), nullable=False),
    sa.Column('grouped', sa.Boolean(), nullable=False),
    sa.Column('func', sa.String(length=200), nullable=True),
    sa.ForeignKeyConstraint(['templateRowId'], ['templateRow.templateRowId'], ),
    sa.PrimaryKeyConstraint('templateRowColumnId')
    )
    op.create_table('templateRow_derivativeTemplateRow',
    sa.Column('templateRowId', sa.Integer(), nullable=False),
    sa.Column('derivativeTemplateRowId', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['derivativeTemplateRowId'], ['templateRow.templateRowId'], ),
    sa.ForeignKeyConstraint(['templateRowId'], ['templateRow.templateRowId'], ),
    sa.PrimaryKeyConstraint('templateRowId', 'derivativeTemplateRowId')
    )
    op.drop_table('tallySheetVersionRow_CE_201_PV_CC')
    op.drop_table('tallySheetVersionRow_PRE_34_Preference')
    op.drop_table('tallySheetVersionRow_ALL_ISLAND_RESULTS_BY_ED')
    op.drop_table('tallySheetVersionRow_CE_201_PV')
    op.drop_table('tallySheetVersionRow_RejectedVoteCount')
    op.alter_column('area_map', 'voteType',
               existing_type=mysql.ENUM('Postal', 'NonPostal', 'PostalAndNonPostal', collation='utf8mb4_unicode_ci'),
               type_=sa.String(length=100),
               nullable=False)
    op.add_column('election', sa.Column('electionTemplateName', sa.String(length=100), nullable=False))
    op.alter_column('election', 'voteType',
               existing_type=mysql.ENUM('Postal', 'NonPostal', 'PostalAndNonPostal', collation='utf8mb4_unicode_ci'),
               type_=sa.String(length=100),
               existing_nullable=False)

    op.add_column('tallySheet', sa.Column('templateId', sa.Integer(), nullable=False))
    op.create_foreign_key(None, 'tallySheet', 'template', ['templateId'], ['templateId'])
    op.drop_column('tallySheet', 'tallySheetCode')
    op.alter_column('tallySheetVersion', 'isComplete',
               existing_type=mysql.TINYINT(display_width=1),
               type_=sa.Boolean(),
               existing_nullable=False)
    op.drop_column('tallySheetVersion', 'tallySheetVersionCode')
    ### end Alembic commands ###


def downgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.add_column('tallySheetVersion', sa.Column('tallySheetVersionCode', mysql.ENUM('CE_201', 'CE_201_PV', 'PRE_28', 'PRE_41', 'PRE_30_PD', 'PRE_30_PD_PV', 'PRE_30_ED', 'PRE_21', 'PRE_34_CO', 'PRE_34_I_RO', 'PRE_34_II_RO', 'PRE_34', 'PRE_ALL_ISLAND_RESULTS_BY_ELECTORAL_DISTRICTS', 'PRE_ALL_ISLAND_RESULTS', 'PRE_34_PD', 'PRE_34_ED', 'PRE_34_AI', collation='utf8mb4_unicode_ci'), nullable=False))
    op.alter_column('tallySheetVersion', 'isComplete',
               existing_type=sa.Boolean(),
               type_=mysql.TINYINT(display_width=1),
               existing_nullable=False)
    op.add_column('tallySheet', sa.Column('tallySheetCode', mysql.ENUM('CE_201', 'CE_201_PV', 'PRE_28', 'PRE_41', 'PRE_30_PD', 'PRE_30_PD_PV', 'PRE_30_ED', 'PRE_21', 'PRE_34_CO', 'PRE_34_I_RO', 'PRE_34_II_RO', 'PRE_34', 'PRE_ALL_ISLAND_RESULTS_BY_ELECTORAL_DISTRICTS', 'PRE_ALL_ISLAND_RESULTS', 'PRE_34_PD', 'PRE_34_ED', 'PRE_34_AI', collation='utf8mb4_unicode_ci'), nullable=False))
    op.drop_constraint(None, 'tallySheet', type_='foreignkey')
    op.drop_column('tallySheet', 'templateId')

    op.alter_column('election', 'voteType',
               existing_type=sa.String(length=100),
               type_=mysql.ENUM('Postal', 'NonPostal', 'PostalAndNonPostal', collation='utf8mb4_unicode_ci'),
               existing_nullable=False)
    op.drop_column('election', 'electionTemplateName')
    op.alter_column('area_map', 'voteType',
               existing_type=sa.String(length=100),
               type_=mysql.ENUM('Postal', 'NonPostal', 'PostalAndNonPostal', collation='utf8mb4_unicode_ci'),
               nullable=True)
    op.create_table('tallySheetVersionRow_RejectedVoteCount',
    sa.Column('tallySheetVersionRowId', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('tallySheetVersionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('electionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('areaId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('candidateId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('rejectedVoteCount', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['areaId'], ['area.areaId'], name='tallySheetVersionRow_RejectedVoteCount_ibfk_1'),
    sa.ForeignKeyConstraint(['candidateId'], ['candidate.candidateId'], name='tallySheetVersionRow_RejectedVoteCount_ibfk_2'),
    sa.ForeignKeyConstraint(['electionId'], ['election.electionId'], name='tallySheetVersionRow_RejectedVoteCount_ibfk_3'),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], name='tallySheetVersionRow_RejectedVoteCount_ibfk_4'),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId'),
    mysql_collate='utf8mb4_unicode_ci',
    mysql_default_charset='utf8mb4',
    mysql_engine='InnoDB'
    )
    op.create_table('tallySheetVersionRow_CE_201_PV',
    sa.Column('tallySheetVersionRowId', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('tallySheetVersionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('ballotBoxId', mysql.VARCHAR(collation='utf8mb4_unicode_ci', length=20), nullable=True),
    sa.Column('numberOfPacketsInserted', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('numberOfAPacketsFound', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], name='tallySheetVersionRow_CE_201_PV_ibfk_1'),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId'),
    mysql_collate='utf8mb4_unicode_ci',
    mysql_default_charset='utf8mb4',
    mysql_engine='InnoDB'
    )
    op.create_table('tallySheetVersionRow_ALL_ISLAND_RESULTS_BY_ED',
    sa.Column('tallySheetVersionRowId', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('tallySheetVersionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('electoralDistrictId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('candidateId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('count', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['candidateId'], ['candidate.candidateId'], name='tallySheetVersionRow_ALL_ISLAND_RESULTS_BY_ED_ibfk_1'),
    sa.ForeignKeyConstraint(['electoralDistrictId'], ['area.areaId'], name='tallySheetVersionRow_ALL_ISLAND_RESULTS_BY_ED_ibfk_2'),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], name='tallySheetVersionRow_ALL_ISLAND_RESULTS_BY_ED_ibfk_3'),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId'),
    mysql_collate='utf8mb4_unicode_ci',
    mysql_default_charset='utf8mb4',
    mysql_engine='InnoDB'
    )
    op.create_table('tallySheetVersionRow_PRE_34_Preference',
    sa.Column('tallySheetVersionRowId', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('tallySheetVersionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('electionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('candidateId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('areaId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('preferenceNumber', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('preferenceCount', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['areaId'], ['area.areaId'], name='tallySheetVersionRow_PRE_34_Preference_ibfk_1'),
    sa.ForeignKeyConstraint(['candidateId'], ['candidate.candidateId'], name='tallySheetVersionRow_PRE_34_Preference_ibfk_2'),
    sa.ForeignKeyConstraint(['electionId'], ['election.electionId'], name='tallySheetVersionRow_PRE_34_Preference_ibfk_3'),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], name='tallySheetVersionRow_PRE_34_Preference_ibfk_4'),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId'),
    mysql_collate='utf8mb4_unicode_ci',
    mysql_default_charset='utf8mb4',
    mysql_engine='InnoDB'
    )
    op.create_table('tallySheetVersionRow_CE_201_PV_CC',
    sa.Column('tallySheetVersionRowId', mysql.INTEGER(display_width=11), nullable=False),
    sa.Column('tallySheetVersionId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('countingCentreId', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('situation', mysql.VARCHAR(collation='utf8mb4_unicode_ci', length=100), nullable=True),
    sa.Column('timeOfCommencementOfCount', mysql.DATETIME(), nullable=True),
    sa.Column('numberOfAPacketsFound', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('numberOfACoversRejected', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('numberOfBCoversRejected', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('numberOfValidBallotPapers', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['countingCentreId'], ['area.areaId'], name='tallySheetVersionRow_CE_201_PV_CC_ibfk_1'),
    sa.ForeignKeyConstraint(['tallySheetVersionId'], ['tallySheetVersion.tallySheetVersionId'], name='tallySheetVersionRow_CE_201_PV_CC_ibfk_2'),
    sa.PrimaryKeyConstraint('tallySheetVersionRowId'),
    mysql_collate='utf8mb4_unicode_ci',
    mysql_default_charset='utf8mb4',
    mysql_engine='InnoDB'
    )
    op.drop_table('templateRow_derivativeTemplateRow')
    op.drop_table('templateRowColumn')
    op.drop_table('templateRow')
    op.drop_table('template')
    op.drop_table('tallySheet_tallySheet')
    op.drop_table('tallySheetVersionRow')
    ### end Alembic commands ###
